# nginx 设置反向代理
web模式: client 端 <=> server 端  

代理: 中间接入一层特定功能的服务器, 即代理服务器  
```
正向代理: 
客户端浏览器没有权限访问某些网站服务器, 需要通过有权限的中间服务器来访问这些网站服务器, 
然后转发到客户端(如vpn); 这样代理了客户端

反向代理: 与正向代理相反  
客户端把请求先发给代理服务器, 代理服务器再通过 nginx 把请求(路由 url)转发到自己设置的服务器上, 设置的服务器将内容返回给客户端浏览器; 这样便代理了服务器
```
## 反向代理的作用
- 安全, 隐藏了真实服务器信息
使用反向代理客户端用户只能通过外来网来访问代理服务器，并且用户并不知道自己访问的真实服务器是那一台，可以很好的提供安全保护

- 负载均衡
反向代理的主要用途是为多个服务器提供负载均衡、缓存等功能。负载均衡就是一个网站的内容被部署在若干服务器上，可以把这些机子看成一个集群，那Nginx可以将接收到的客户端请求“均匀地”分配到这个集群中所有的服务器上，从而实现服务器压力的平均分配，也叫负载均衡。

## 反向代理指令
```
# 访问http://xxxx.com 然后反向代理到http://oooo.com这个网站
server{
  listen 80;
  server_name  xxxx.com;
  location / {
    # 也可以是 ip 地址
    proxy_pass http://oooo.com;
  }
}
```

## 其他指令
- proxy_set_header  
在将客户端请求发送给后端服务器之前，更改来自客户端的请求头信息。

- proxy_connect_timeout  
配置Nginx与后端代理服务器尝试建立连接的超时时间。

- proxy_read_timeout  
配置Nginx向后端服务器组发出read请求后，等待相应的超时时间。

- proxy_send_timeout  
配置Nginx向后端服务器组发出write请求后，等待相应的超时时间。

- proxy_redirect  
用于修改后端服务器返回的响应头中的Location和Refresh